<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Nathan Fisher - DevOp - JunctionBox.ca</title>
   <meta name="author" content="" />

   <!--- Blueprint CSS Framework -->
   <link rel="stylesheet" href="/css/blueprint/screen.css" type="text/css" media="screen, projection">
   <link rel="stylesheet" href="/css/blueprint/print.css" type="text/css" media="print">
   <!--[if IE]>
      <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection">
   <![endif]-->

   <!-- CodeRay syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/coderay.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/site.css" type="text/css" media="screen, projection" />
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-713228-10']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
	</head>
<body>

<div class="container">

   <div class="column span-24 first last" id="header">
     <p class="title"><a href="/?ref=mast">JunctionBox.ca</a></p>
     <p><a href="/?ref=nav">Home</a> | <a href="/articles/?ref=nav">Articles</a> | <a href="/resources/?ref=nav">Resources</a> | <a href="/nathan-fisher.html?ref=nav">Contact</a></p>
     <hr/>
   </div>

   <div class="column span-17 first">
      <p class="title">Nathan Fisher - DevOp</p>

<p class="quiet">DevOps is a common sense approach to software release cycles. It's an accumulation of best practices and the agreement that software has no business value until it's in the hands of its intended user. The name is derived from the curious union of development and operations and is most commonly described as a "bridge of communication" between developers and operations. Criticise if you will, but when people have their head in code they sometimes don't take into account the bigger picture. Ultimately that's what it's all about. Common tools of the trade include: virtualization, configuration management, CI, and automation of as much as reasonable. If you're interested in knowing more take a look at Jez Humbles book <a href="http://continuousdelivery.com/">Continuous Delivery</a>.</p>







<h2>Branching by Abstraction 101</h2>
<p>Committing to mainline is an important feature of CI and always keeping your mainline deployable is a requisite for Continuous Delivery.  So what&#8217;s an easy way to maintain code quality and get new features in? Feature Flags and Branching by Abstraction!</p>
<p>So what exactly does this look like?</p>
<p>Let&#8217;s start with a simple function that outputs your name:</p>
<pre>
def name
	@first_name
end
</pre>
<p>Now we want to change the function but it&#8217;s going to be significant in someway, how would we achieve that? The simplest way would be to introduce a binary variable that allows flow control. I&#8217;m not a big fan of this option as it can potentially require a lot of overhead to wire in configuration files to it.</p>
<pre>
def name
	return name_flag_name2 if @enable_name2
	@name
end

def name_flag_name2
	# TBD
end
</pre>
<p>That&#8217;s a simple on/off approach for rolling out a new feature what if you want to do canary releases?  Well you&#8217;ll need something that handles a little more logic:</p>
<pre>
def name
	return name_flag_name2 if @features.enabled?(:enable_name2, @user_account_type)
	@name
end
</pre>
<p>I leave the implementation of the settings manager to the user as there are any number of ways you may wish to wire it up.</p>
<p><a href="/articles/2011/05/28/branching-by-abstraction-101.html?ref=home#disqus_thread" data-disqus-identifier="/articles/2011/05/28/branching-by-abstraction-101.html">Comments</a></p>
<hr/>










<h2>Bootstrapping Windows</h2>
<p>Finding myself back in the Windows domain I really miss package repository tools like YUM and apt-get.  In what seems eons ago I used a toolset called Unattended for windows installations.  It&#8217;s a little rough around the edges but it gave me some interesting ideas.  I put together a quick script to download some common tools I find myself using on windows servers.</p>
<p>Here&#8217;s the general code cobbled together;</p>
<pre>
Const BINARY = 1
Const SAVE_CREATE_OVERWRITE = 2
Const SAVE_CREATE_NOT_EXIST = 1
Const ERR_DOWNLOAD_FILE_UNAVAILABLE = -1
Const ERR_DOWNLOAD_FILE_UNSAVABLE = -2
temp = WScript.CreateObject("Scripting.FileSystemObject").GetSpecialFolder(2).Path &amp; "\"

Dim http, WshShell, file_stream

Set WshShell = WScript.CreateObject("WScript.Shell")



download_file "http://javadl.sun.com/webapps/download/AutoDL?BundleId=44457", "jre.exe"
WshShell.Run temp &amp; "jre.exe /s /v ""/qn ADDLOCAL=ALL IEXPLORER=1""", 1, TRUE
' JRE


' Download a file to the temp folder and specified filename.
'
'
Function download_file(src, dest)
	' TODO: Add better error handling for http and file handles.

	Set http = CreateObject("MSXML2.ServerXMLHTTP")

	If IsNull(http) Then
		WScript.Echo "Microsoft.XmlHttp creation failed"
	End If

	http.open "GET", src, FALSE
	http.send

	Set file_stream = CreateObject("Adodb.Stream")

	file_stream.type = BINARY
	file_stream.open
	file_stream.write http.responseBody
	file_stream.saveToFile temp &amp; dest, SAVE_CREATE_OVERWRITE 
	file_stream.close

	Set file_stream = nothing
	Set http = nothing
End Function
</pre>
<p><a href="/articles/2011/02/10/bootstrapping-windows.html?ref=home#disqus_thread" data-disqus-identifier="/articles/2011/02/10/bootstrapping-windows.html">Comments</a></p>
<hr/>





<h2>Initial Configuration of Puppetd on OS X</h2>
<p>Configuring puppetd on OS X</p>
<p>Create the User and Group accounts;</p>
<pre>
sudo dscl . -create /Groups/puppet
sudo dscl . -create /Groups/puppet PrimaryGroupID 300

sudo dscl . -create /Users/puppet
sudo dscl . -create /Users/puppet PrimaryGroupID 300
sudo dscl . -create /Users/puppet UniqueID 300
sudo dscl . -create /Users/puppet UserShell /usr/bin/false
</pre>
<p>Create the folders</p>
<pre>
sudo mkdir /etc/puppet
sudo mkdir -p /var/puppet/log
sudo chown -R puppet:puppet /var/puppet
sudo chown -R puppet:puppet /etc/puppet
</pre>
<p>Create the config file.</p>
<pre>
sudo puppetd --genconfig &gt; /etc/puppet/puppet.conf
</pre>
<p>Modify your /etc/hosts file with an entry for puppet (setting the server in the puppet.conf offers more flexibility should you move servers or change IP&#8217;s).</p>
<p>If you run into issues with your certificates;</p>
<h4>Client</h4>
<pre>
rm -rf /etc/puppet/ssl
</pre>
<h4>Server</h4>
<pre>
puppetca --clean CERT_ID
</pre>
<p><a href="/articles/2010/10/05/initial-configuration-of-puppetd-on-os-x.html?ref=home#disqus_thread" data-disqus-identifier="/articles/2010/10/05/initial-configuration-of-puppetd-on-os-x.html">Comments</a></p>
<hr/>


<p><a href="/articles/">More Articles</a></p>

   </div>

   <div class="column span-6 prepend-1 last">
      <div class="box">
			<img src="http://www.myopenid.com/image?id=142724"/>
      <h4>About JunctionBox.ca</h4>
      <p><a href="http://junctionbox.ca/?ref=about">JunctionBox.ca</a> is the online blog of Nathan Fisher.  I'm a computer geek who loves the outdoors.  During the week you'll find me bridging the gap between developers and operations as a <a href="http://en.wikipedia.org/wiki/DevOps">DevOp</a> at ThoughtWorks, in London.</p>
      </div>

			<h5>Recent Articles</h5>
			<ul>
		
						<li><a href="/articles/2011/05/28/branching-by-abstraction-101.html?ref=recent">Branching by Abstraction 101</a></li>
		
		
				
		
		
						<li><a href="/articles/2011/02/10/bootstrapping-windows.html?ref=recent">Bootstrapping Windows</a></li>
		
		
						<li><a href="/articles/2010/10/05/initial-configuration-of-puppetd-on-os-x.html?ref=recent">Initial Configuration of Puppetd on OS X</a></li>
		
		
						<li><a href="/articles/2010/08/01/dance-and-pivot-sql-style.html?ref=recent">Dance and Pivot SQL Style</a></li>
		
		
						<li><a href="/articles/2010/04/17/simplified-tdd-with-sinatra-autotest.html?ref=recent">Simplified TDD with Sinatra autotest</a></li>
		
		
			</ul>
			<p><a href="/articles/?ref=recent">More Articles</a></p>		

      <h5>Blog Roll</h5>
			<ul>
			<li><a href="http://dailyinteractive.ca/">DailyInteractive.ca</a></li>
			<li><a href="http://migz.ca/">Migz.ca</a></li>
			<li><a href="http://etlgfx.com/">ETL gfx</a></li>
			<li><a href="http://littlekitchen.ca/">Little Kitchen</a></li>
			<li><a href="http://matthewkantor.com/">Matthew Kantor</a></li>
			<li><a href="http://continuousdelivery.com/">Continous Delivery - Jez Humble</a></li>
			<li><a href="http://www.samnewman.org/">Sam Newman</a></li>
			</ul>
   </div>

   <div class="column span-24 first last" id="footer">
     <hr />
     <p><a href="/?ref=footer">Home</a> | <a href="/articles/?ref=footer">Articles</a> | <a href="/resources/?ref=footer">Resources</a> | <a href="/nathan-fisher.html?ref=footer">Contact</a> | All content written by Nathan Fisher unless otherwise noted.</p>
   </div>

</div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'junctionboxca'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = '/';
    var disqus_url = '/';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
</body>
</html>
